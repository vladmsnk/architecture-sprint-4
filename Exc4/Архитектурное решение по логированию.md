#### Анализ системы

На текущий момент система не поддерживает центразиованное логирование.
Возможно, можно смотреть логи в контейнерах или подах, в которых запущены системы, но это неудобно.
Например, в случае, если компонент MES API когда-то завершился с ошибкой, сложно будет найти, какая именно ошибка возникла.

Структура логов:
- временная метка timestamp
- уровень логирования
- сервис
- сообщение
- trace_id (если tracing уже будет интегрирован)
- хост, с которого был отправлен лог

Пример структуры лога
```json
{
  "timestamp": "2024-12-27T10:45:00.123Z",
  "level": "ERROR",
  "service": "MES API",
  "message": "Failed query",
  "trace_id": "some_trace_id",
  "hostname": "ip of the pod or container"
}
```

Определим, из каких систем требуется сбор и последующее хранение логов:

- Shop API:
  - Начало и завершение процесса создания заказа необходимо логировать с уровнем INFO
В лог необходимо добавлять идентификатор заказа, а идентификаторы связанных сущностей
  - Также транзитные переходы состояния заказа можно логировать с уровнем INFO
  - Невозможность перевести заказа из одного состояния в другое логируем с уровнем WARN, 
  так как это нестандартное поведение.
  - Все возникающие ошибки в логике и при обращении к сторонним сервисам необходимо логировать с уровнем ERROR

MES API:
  - Начало и завершение процесса подсчета стоимости заказа логируем с уровнем INFO
  - Если процесс подсчета стоимости заказа занимает большое количество времени (больше, чем допустимый порог), логируем с уровнем WARN
  - Все остальные ошибки в бизнес логике или при обращении к сторонним сервисам логируем с уровнем ERROR

CRM API:
  - Создание или изменение статуса заказа через CRM логируем с уровнем INFO
  - Все остальные ошибки в бизнес логике или при обращении к сторонним сервисам логируем с уровнем ERROR

Также с уровнем логирования WARN можно помечать ситуации деградации системы, например, в случае, когда использование RAM 
достигает 85%

#### Мотивация

Логирование позволяет оперативно выявлять и устранять проблемы в работе системы,
сокращая время простоя и повышая надежность сервисов

Метрики, на которые позитивно повлияет интеграция логирования
1) Скорость решения инцидентов — логирование позволит быстро локализировать проблемы и быстро их устранять
2) Снижение финансовых потерь — быстрое нахождение и устранение минимизирует потери прибыли из-за недоступности системы
3) Эффективность работы команды — логирование уменьшит количество времени, требуемое на поиск неисправностей, тем самым
команда разработки сможет эффективнее выполнять свои задачи

#### Предлагаемое решение
1) Развернуть Elasticsearch и настроить конфигурацию
2) Развернуть Logstash и настроить файл конфигурации пайплайна, запустить Logstash
3) Развернуть Kibana и настроить на отображение логов
4) Внедрить логирование в сервисы с использованием сторонних библиотек
5) Настройка авторизации при доступе к логам, дополнительно можно настрить шифрование с помощью TLS 
